<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="lt-ie10 lt-ie9"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="lt-ie10"> <![endif]-->
<!--[if gt IE 10]><!--><html lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8" />
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="//fonts.googleapis.com" rel="dns-prefetch" />
  <link href="//ajax.googleapis.com/" rel="dns-prefetch" />
  <link href="//www.google-analytics.com" rel="dns-prefetch" />
  <link href="//html5shim.googlecode.com" rel="dns-prefetch" />
  
      <title>Creating a WiX installer for a .NET Web Project &ndash; Utopian Concept LLC</title>
      <meta content="Creating a WiX installer for a .NET Web Project" property="og:title">
      <meta content="Creating a WiX installer for a .NET Web Project" name="twitter:title">
    
  <meta content="Utopian Concept LLC" property="og:site_name">
  
      <meta content="Utopian Concept LLC is a bespoke development company. Experienced with all aspects of development ranging from web, mobile, desktop, and client/server." name="description">
      <meta content="Utopian Concept LLC is a bespoke development company. Experienced with all aspects of development ranging from web, mobile, desktop, and client/server." property="og:description">
      <meta content="Utopian Concept LLC is a bespoke development company. Experienced with all aspects of development ranging from web, mobile, desktop, and client/server." name="twitter:description">
  
  <meta name="author" content="Ray Clanan" />
  <link href="https://plus.google.com/117308858606542676324/posts" rel="author">
  <meta name="twitter:site" content="@utopianconcept">
  <meta name="twitter:creator" content="@rclanan">
  
  <meta name='og:email' content="rclanan@utopianconcept.com">
  
  
  <meta name='og:phone_number' content="+1 317-586-2186">
  
  <link rel="alternate" type="application/atom+xml" title="Atom" href="/atom.xml" />
  <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link href="http://utopianconcept.com/posts/creating-a-wix-installer-for-a-.net-web-project" rel="canonical">
  <link type="text/plain" rel="author" href="http://utopianconcept.com/humans.txt">
  
    <meta content="article" property="og:type">
  
  <meta content="summary" name="twitter:card">
  
    <meta content="http://utopianconcept.com/posts/creating-a-wix-installer-for-a-.net-web-project" property="og:url">
    <meta content="http://utopianconcept.com/posts/creating-a-wix-installer-for-a-.net-web-project" name="twitter:url">
  
  
    <meta http-equiv="date" content="Monday, 12  2013 00:00:00 GMT" />
    <meta content="2013-08-12T00:00:00-04:00" property="article:published_time">
    <meta content="http://utopianconcept.com/about/" property="article:author">
  
  
    <meta property="og:image" content="http://utopianconcept.com/images/logo-high-resolution.png">
    <meta name="twitter:image:src" content="http://utopianconcept.com/images/logo-high-resolution.png">
  
  
    <meta property="article:section" content="coding">
  
  
    
    <meta property="article:tag" content=".net">
    
    <meta property="article:tag" content="WiX">
    
    <meta property="article:tag" content="web">
    
    <meta property="article:tag" content="project">
    
    <meta property="article:tag" content="installer">
    
    <meta property="article:tag" content="howto">
    
  
  
    <meta property="fb:admins" content="ray.clanan" />
    <meta property="fb:app_id" content="619415181409836"/>
  

  
    <meta name="keywords" content=".net,WiX,web,project,installer,howto" />
  

  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300'
    rel='stylesheet' type='text/css'>
  <link href="/css/styles.css" rel="stylesheet">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="apple-touch-icon-144x144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="apple-touch-icon-114x114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="apple-touch-icon-72x72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="apple-touch-icon-57x57-precomposed.png">

  <meta name="robots" content="INDEX,FOLLOW" />
</head>

<body>
  <header id="navbar" class="navbar navbar-fixed-top" role="banner">
    <div class="container">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/" title="Utopian Concept LLC Index">Utopian Concept LLC</a>
      <nav class="nav-collapse collapse navbar-responsive-collapse" role="navigation">
        <ul class="nav navbar-nav pull-right hidden-print lowercase">
          <li><a title="See the post list" href="/">Posts</a></li>
          <li><a title="About me" href="/about">About</a></li>
          <li><a title="Technology I use" href="/technology">Technology</a></li>
          <li><a title="Some of my side projects" href="/labs">Labs</a></li>
          <li><a title="Freelancing Information" href="/freelance">Hire Me</a></li>
          <li><a title="Contact me" href="/contact">Contact</a></li>
          <li><a title="Recommendations" href="/recommendations">Recommendations</a></li>
          <li><a title="Atom Feed" href="/atom.xml">RSS</a></li>
        </ul>
      </nav>
    </div>
  </header>

  


<section class="container" role="main">
  <article class="content" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
  <h2 itemprop="name headline">
    <a href="/posts/creating-a-wix-installer-for-a-.net-web-project" itemprop="url">Creating a WiX installer for a .NET Web Project</a>
  </h2>
  </header>
  <section class="byline">
    <meta itemprop="description" content="A brief walk through on how to create a WiX installer for a .NET web project">
    Written by
      <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">
            <a href="https://plus.google.com/117308858606542676324" itemprop="url" rel="author">Ray Clanan</a>
        </span>
    </span>
    on
    <i class="icon-calendar"></i> <time title="2013-08-12T00:00:00-04:00" pubdate="2013-08-12T00:00:00-04:00" itemprop="datePublished">August 12, 2013</time>
    <span class="post-details pull-right">
      <small>Categories:
        
          
            <a href="coding" title="View posts categorized with &quot;coding&quot;"><span class="label">coding</span></a>
          
        
      | Tags:
        
          
            <a href="/tags/.net" title="View posts tagged with &quot;.net&quot;"><span class="label">.net</span></a>
          
            <a href="/tags/WiX" title="View posts tagged with &quot;WiX&quot;"><span class="label">WiX</span></a>
          
            <a href="/tags/web" title="View posts tagged with &quot;web&quot;"><span class="label">web</span></a>
          
            <a href="/tags/project" title="View posts tagged with &quot;project&quot;"><span class="label">project</span></a>
          
            <a href="/tags/installer" title="View posts tagged with &quot;installer&quot;"><span class="label">installer</span></a>
          
            <a href="/tags/howto" title="View posts tagged with &quot;howto&quot;"><span class="label">howto</span></a>
          
        
        | <a href="http://utopianconcept.com/posts/creating-a-wix-installer-for-a-.net-web-project"><span class="label label-info">Permalink</span></a>

        | <a href="http://www.instapaper.com/hello2?url=http://utopianconcept.com/posts/creating-a-wix-installer-for-a-.net-web-project&amp;title=Creating a WiX installer for a .NET Web Project" title="Save Creating a WiX installer for a .NET Web Project to Instapaper" target="_blank">Read later</a>
        </small>
    </span>
  </section>

  <section class="entry" itemprop="articleBody">
    <p>The other day I was wrapping up some changes to a production web service at a clients, got ready to fill out the deployment instructions when I noticed that there was no installer package or previous deployment plan in place and this was a service that had been in production for quite some time now. The client has since started using WiX for all of their deployment packages.</p>

<p>With that being said, I figured I would share the steps I used to create the WiX installer for this web service I was getting ready to deploy.</p>

<p>First create a new WiX project in the solution where the web project is.</p>

<p><img src="http://farm8.staticflickr.com/7326/9472180915_ef89a463d3.jpg" alt="Add New Project"></p>

<p>I like to contain all my &ldquo;settings&rdquo; in an include file for easier maintenance. To do so the next step I do is to create an include file called Configuration.wxi.</p>

<p><img src="http://farm3.staticflickr.com/2853/9474968680_48cb47c7d1.jpg" alt="Add New Item"></p>

<p>Some of the basic elements I define in the configuration include file are:</p>

<ul>
<li>Product Name - Name of the product you are installing</li>
<li>Product Title - Title of the product you are installing</li>
<li>Manufacturer - Your company name</li>
<li>App URL - URL to point to more information about the application or the application itself</li>
<li>Description - Brief overview of what the application is for</li>
<li>Comments - Additional note about the application</li>
<li>Install Version - Version of the product. This can be auto incremented with the use of certain build scripts but for this client they controlled this setting manually.</li>
<li>Upgrade Code - Product GUID used for tracking upgrades</li>
</ul>

<p>So you will end up with something that looks along the lines of this:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot; 1.0&quot; encoding=&quot; utf-8&quot;?&gt;</span>
  <span class="nt">&lt;Include&gt;</span>
    <span class="cp">&lt;? define ProductName=&quot;Business Web Service&quot; ?&gt;</span>
    <span class="cp">&lt;? define ProductTitle=&quot;Business Web Service&quot; ?&gt;</span>
    <span class="cp">&lt;? define Manufacturer=&quot;Business Name, Inc.&quot; ?&gt;</span>
    <span class="cp">&lt;? define AppURL=&quot;http://www.businessname.com&quot; ?&gt;</span>
    <span class="cp">&lt;? define Description=&quot;Installer for Business Web Service&quot; ?&gt;</span>
    <span class="cp">&lt;? define Comments=&quot;Business Web Service Installer&quot; ?&gt;</span>
    <span class="cp">&lt;? define InstallVersion=&quot;1.0.0.0 ?&gt;</span>
    <span class="cp">&lt;? define UpgradeCode=&quot;YOUR-GUID-HERE&quot; ?&gt;</span>
<span class="nt">&lt;/Include&gt;</span>
</code></pre></div>
<p>Next thing we need to do is update our references. We will want to add two references.</p>

<ol>
<li>The project

<ul>
<li>Change Harvest to False</li>
<li>Change Project Output Groups to None</li>
</ul></li>
<li>WiXUIExtension</li>
</ol>

<p>Now we need to edit the WiX installer project file. At the top of the project file we need to enable project havesting. To the top of the file in the PropertyGroup element add:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot; 1.0&quot; encoding=&quot; utf-8&quot;?&gt;</span>
<span class="nt">&lt;Project</span> <span class="na">ToolsVersion=</span><span class="s">&quot; 4.0&quot;</span> <span class="na">DefaultTargets=</span><span class="s">&quot; Build&quot;</span> <span class="na">xmlns=</span><span class="s">&quot; http://schemas.microsoft.com/developer/msbuild/2003 &quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;PropertyGroup&gt;</span>
    <span class="nt">&lt; EnableProjectHarvesting&gt;</span>True <span class="nt">&lt;/EnableProjectHarvesting&gt;</span>
</code></pre></div>
<p>Under the ItemGroup that references your projects solution we need to add a tag to let WiX know that this is a web project. This will be used for conditional statements later on:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;ItemGroup&gt;</span>
    <span class="nt">&lt; ProjectReference</span> <span class="na">Include =</span><span class="s">&quot;..\BusinessWebService\BusinessWebService.csproj &quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt; Name&gt;</span>BusinessWebService <span class="nt">&lt;/Name&gt;</span>
      <span class="nt">&lt; Project&gt;</span>{PROJECT-GUID-HERE} <span class="nt">&lt;/Project&gt;</span>
      <span class="nt">&lt; Private&gt;</span>True <span class="nt">&lt;/Private&gt;</span>
      <span class="nt">&lt; DoNotHarvest&gt;</span>True <span class="nt">&lt;/DoNotHarvest&gt;</span>
      <span class="nt">&lt; RefProjectOutputGroups&gt;</span>
      <span class="nt">&lt;/ RefProjectOutputGroups&gt;</span>
      <span class="nt">&lt; RefTargetDir&gt;</span>INSTALLFOLDER <span class="nt">&lt;/RefTargetDir&gt;</span>
      <span class="nt">&lt; WebProject&gt;</span>True <span class="nt">&lt;/WebProject&gt;</span>
    <span class="nt">&lt;/ ProjectReference&gt;</span>
<span class="nt">&lt;/ItemGroup&gt;</span>
</code></pre></div>
<p>Next we need to add a custom target that will get trigger before the build. To do so at the end of the file add:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml">      <span class="nt">&lt;Target</span> <span class="na">Name=</span><span class="s">&quot; BeforeBuild&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/Target&gt;</span>
<span class="nt">&lt;/Project&gt;</span>
</code></pre></div>
<p>We need to define four elements in this target. For more detailed information on these elements visit the wix documentation.</p>

<ul>
<li>MSBuild - Sets up the conditional to look for the WebProject condition that we setup previously</li>
<li>PropertyGroup - Used to define a constant that points to the PackageDir</li>
<li>ItemGroup - Used to specify the input paths for the linker</li>
<li>HeatDirectory - Controls the collection of files needed to be included in this web project. Heat is a time saver as otherwise you would have to specify all of your files manually.</li>
</ul>

<p>For my project, I ended up with something that looks like this:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;Target</span> <span class="na">Name=</span><span class="s">&quot; BeforeBuild&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt; MSBuild</span> <span class="na">Projects =</span><span class="s">&quot;%(ProjectReference.FullPath) &quot;</span>
             <span class="na">Targets=</span><span class="s">&quot; Package&quot;</span>
             <span class="na">Properties=</span><span class="s">&quot; Configuration=$(Configuration);Platform=AnyCPU &quot;</span>
             <span class="na">Condition=</span><span class="s">&quot; &#39;%(ProjectReference.WebProject)&#39;==&#39;True&#39;&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt; PropertyGroup&gt;</span>
      <span class="nt">&lt; DefineConstants</span> <span class="na">Condition =</span><span class="s">&quot;&#39;%(ProjectReference.WebProject)&#39;==&#39;True&#39; &quot;</span><span class="nt">&gt;</span>
        %(ProjectReference.Name).PackageDir=%(ProjectReference.RootDir)%(ProjectReference.Directory)obj\$(Configuration)\Package\PackageTmp\
      <span class="nt">&lt;/ DefineConstants&gt;</span>
    <span class="nt">&lt;/ PropertyGroup&gt;</span>
    <span class="nt">&lt; ItemGroup&gt;</span>
      <span class="nt">&lt; LinkerBindInputPaths</span> <span class="na">Include=</span><span class="s">&quot; %(ProjectReference.RootDir)%(ProjectReference.Directory)obj\$(Configuration)\Package\PackageTmp\ &quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/ ItemGroup&gt;</span>
    <span class="nt">&lt; HeatDirectory</span> <span class="na">OutputFile =</span><span class="s">&quot;%(ProjectReference.Filename).wxs &quot;</span>
                   <span class="na">Directory=</span><span class="s">&quot; %(ProjectReference.RootDir)%(ProjectReference.Directory)obj\$(Configuration)\Package\PackageTmp\ &quot;</span>
                   <span class="na">DirectoryRefId=</span><span class="s">&quot; INSTALLLOCATION&quot;</span>
                   <span class="na">ComponentGroupName=</span><span class="s">&quot; %(ProjectReference.Filename)_Project&quot;</span>
                   <span class="na">AutoGenerateGuids=</span><span class="s">&quot; false&quot;</span>
                   <span class="na">GenerateGuidsNow=</span><span class="s">&quot; true&quot;</span>
                   <span class="na">SuppressCom=</span><span class="s">&quot; true&quot;</span>
                   <span class="na">SuppressFragments=</span><span class="s">&quot; true&quot;</span>
                   <span class="na">SuppressRegistry=</span><span class="s">&quot; true&quot;</span>
                   <span class="na">SuppressRootDirectory=</span><span class="s">&quot; true&quot;</span>
                   <span class="na">ToolPath=</span><span class="s">&quot; $(WiXToolPath)&quot;</span>
                   <span class="na">Condition=</span><span class="s">&quot; &#39;%(ProjectReference.WebProject)&#39;==&#39;True&#39;&quot;</span>
                   <span class="na">Transforms=</span><span class="s">&quot; %(ProjectReference.Filename).xsl&quot;</span>
                   <span class="na">PreprocessorVariable=</span><span class="s">&quot; var.%(ProjectReference.Name).PackageDir&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/Target&gt;</span>
</code></pre></div>
<p>Normally, you would want it to auto generate the GUIDs for you but that option can not be used if your installing to a non-standard directory location. Once the rest of the pieces are in place, we will get a new file in our projects directory that you will need to manually include to your projects source tree once we build it for the first time.</p>

<p>Next I need to add an XSL file to our project that will control the omitting of certain files that I don&rsquo;t want to include in the file installer. For this project, since the client doesn&rsquo;t want to push out xml or config files. I will omit them from the installer using an Xsl Stylesheet defined in the Transorms property earlier in the Target element of the project file.</p>

<p><img src="http://farm3.staticflickr.com/2840/9472180923_756dc0b1a7.jpg" alt="Add New Item"></p>

<p>This file will look like:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot; 1.0&quot; encoding=&quot; utf-8&quot;?&gt;</span>

<span class="nt">&lt;xsl:stylesheet</span> <span class="na">version=</span><span class="s">&quot; 1.0&quot;</span> <span class="na">xmlns:xsl=</span><span class="s">&quot; http://www.w3.org/1999/XSL/Transform&quot;</span>
                <span class="na">xmlns:wix=</span><span class="s">&quot; http://schemas.microsoft.com/wix/2006/wi&quot;</span>
                <span class="na">xmlns:msxsl=</span><span class="s">&quot; urn:schemas-microsoft-com:xslt&quot;</span> <span class="na">exclude-result-prefixes=</span><span class="s">&quot; msxsl&quot;</span><span class="nt">&gt;</span>

  <span class="nt">&lt;xsl:output</span> <span class="na">method=</span><span class="s">&quot; xml&quot;</span> <span class="na">indent=</span><span class="s">&quot; yes&quot;</span> <span class="nt">/&gt;</span>

  <span class="c">&lt;!--Identity Transform--&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot; @*|node()&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt; xsl:copy&gt;</span>
      <span class="nt">&lt; xsl:apply-templates</span> <span class="na">select =</span><span class="s">&quot;@*|node() &quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/ xsl:copy&gt;</span>
  <span class="nt">&lt;/xsl:template&gt;</span>

  <span class="c">&lt;!--Set up keys for ignoring various file types--&gt;</span>
  <span class="nt">&lt;xsl:key</span> <span class="na">name=</span><span class="s">&quot; config-search&quot;</span>
           <span class="na">match=</span><span class="s">&quot; wix:Component[contains(wix:File/@Source, &#39;.config&#39;) and not(contains(wix:File/@Source, &#39;.production&#39;))]&quot;</span>
           <span class="na">use=</span><span class="s">&quot; @Id&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;xsl:key</span> <span class="na">name=</span><span class="s">&quot; wixlib-search&quot;</span> <span class="na">match=</span><span class="s">&quot; wix:Component[contains(wix:File/@Source, &#39;.wixlib&#39;)]&quot;</span> <span class="na">use =</span><span class="s">&quot;@Id &quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;xsl:key</span> <span class="na">name=</span><span class="s">&quot; svn-search&quot;</span> <span class="na">match=</span><span class="s">&quot; wix:Component[ancestor::wix:Directory/@Name = &#39;.svn&#39;]&quot;</span> <span class="na">use =</span><span class="s">&quot;@Id &quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;xsl:key</span> <span class="na">name=</span><span class="s">&quot; xml-search&quot;</span> <span class="na">match=</span><span class="s">&quot; wix:Component[contains(wix:File/@Source, &#39;.xml&#39;)]&quot;</span> <span class="na">use =</span><span class="s">&quot;@Id &quot;</span> <span class="nt">/&gt;</span>

  <span class="c">&lt;!--Match and ignore .config files--&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot; wix:Component[key(&#39;config-search&#39;, @Id)]&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot; wix:ComponentRef[key(&#39;config-search&#39;, @Id)] &quot;</span> <span class="nt">/&gt;</span>

  <span class="c">&lt;!--Match and ignore leftover .wixlib files on developer machines --&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot; wix:Component[key(&#39;wixlib-search&#39;, @Id)]&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot; wix:ComponentRef[key(&#39;wixlib-search&#39;, @Id)] &quot;</span> <span class="nt">/&gt;</span>

  <span class="c">&lt;!--Match and ignore “.svn&quot; directories on build machines --&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot; wix:Directory[@Name = &#39;.svn&#39;]&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot; wix:ComponentRef[key(&#39;svn-search&#39;, @Id)]&quot;</span> <span class="nt">/&gt;</span>

  <span class="c">&lt;!--Match and ignore leftover .xml files on developer machines --&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot; wix:Component[key(&#39;xml-search&#39;, @Id)]&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot; wix:ComponentRef[key(&#39;xml-search&#39;, @Id)]&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</code></pre></div>
<p>Now we can move to our final file which should be named Product.wxs. This file is the key to controlling all aspects of the installer. The first thing we need to include is our include file. We will do so using the &lt;?include ?&gt; directive.</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot; 1.0&quot; encoding=&quot; UTF-8&quot;?&gt;</span>
<span class="nt">&lt;WiX</span> <span class="na">xmlns=</span><span class="s">&quot; http://schemas.microsoft.com/wix/2006/wi&quot;</span><span class="nt">&gt;</span>
  <span class="cp">&lt;?include Configuration.wxi ?&gt;</span>
</code></pre></div>
<p>With our configuration file included, we will now have access to all of the variables that we defined earlier in the form of $(var.VariableName). Let&rsquo;s configure the Product element next.</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;Product</span> <span class="na">Id=</span><span class="s">&quot; *&quot;</span>
           <span class="na">Name=</span><span class="s">&quot; $(var.ProductName)&quot;</span>
           <span class="na">Language=</span><span class="s">&quot; 1033&quot;</span>
           <span class="na">Version=</span><span class="s">&quot; $(var.InstallVersion)&quot;</span>
           <span class="na">Manufacturer=</span><span class="s">&quot; $(var.Manufacturer)&quot;</span>
           <span class="na">UpgradeCode=</span><span class="s">&quot; $(var.UpgradeCode)&quot;</span><span class="nt">&gt;</span>
</code></pre></div>
<p>Next we will move onto the Package element:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;Package</span> <span class="na">Id=</span><span class="s">&quot; *&quot;</span>
             <span class="na">Description=</span><span class="s">&quot; $(var.Description)&quot;</span>
             <span class="na">Comments=</span><span class="s">&quot; $(var.Comments)&quot;</span>
             <span class="na">Manufacturer=</span><span class="s">&quot; $(var.Manufacturer)&quot;</span>
             <span class="na">InstallerVersion=</span><span class="s">&quot; 200&quot;</span>
             <span class="na">Languages=</span><span class="s">&quot; 1033&quot;</span>
             <span class="na">Compressed=</span><span class="s">&quot; yes&quot;</span>
             <span class="na">SummaryCodepage=</span><span class="s">&quot; 1252&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>From there we can go on to configure our Feature element:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;Feature</span> <span class="na">Id=</span><span class="s">&quot; ProductFeature&quot;</span> <span class="na">Title=</span><span class="s">&quot; $(var.ProductTitle)&quot;</span> <span class="na">Level=</span><span class="s">&quot; 1&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt; ComponentGroupRef</span> <span class="na">Id =</span><span class="s">&quot;BusinessWebService_Project &quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt; ComponentGroupRef</span> <span class="na">Id =</span><span class="s">&quot;Product.Generated &quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/ Feature&gt;</span>
</code></pre></div>
<p>The default Product file comes with a Fragment whose Id is called ProductComponents. We can remove that since we will be using Heat to create that fragment. Otherwise we would have to specify each of our files in that fragment manually.</p>

<p>Now we need to configure the InstallLocation to point to where we want to program to be installed initially.</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt; Directory</span> <span class="na">Id =</span><span class="s">&quot; TARGETDIR &quot;</span> <span class="na">Name =</span><span class="s">&quot; SourceDir &quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt; Directory</span> <span class="na">Id =</span> <span class="s">&quot;PROGRAMFILES &quot;</span> <span class="na">Name =</span> <span class="s">&quot;Program Files &quot;</span> <span class="nt">&gt;</span>
        <span class="nt">&lt; Directory</span> <span class="na">Id =</span> <span class="s">&quot;INSTALLLOCATION &quot;</span> <span class="na">Name =</span> <span class="s">&quot;BusinessWebService &quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/ Directory &gt;</span>
<span class="nt">&lt;/ Directory &gt;</span>
</code></pre></div>
<p>We also need to declare a property that will tell WiX where the installlocation is:</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;Property</span> <span class="na">Id=</span><span class="s">&quot; WIXUI_INSTALLDIR&quot;</span> <span class="na">Value=</span><span class="s">&quot; INSTALLLOCATION&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>After that you should be ready to build your installer. Upon a successful build you will need to include the file that was generated in the project&rsquo;s folder. You will end up with a structure like:</p>

<p><img src="http://farm4.staticflickr.com/3825/9474968650_c528df53ff_s.jpg" alt="Add New Item"></p>

<p>Until next time&hellip;</p>

<h3>References:</h3>

<ul>
<li>C Surfleet. (2011, June 30). Simplify Deployment with Visual Studio and WiX [Web log post]. Retrieved from <a href="http://www.chrissurfleet.co.uk/post/simplify-deployment-with-visual-studio-and-wix.aspx">http://www.chrissurfleet.co.uk/post/simplify-deployment-with-visual-studio-and-wix.aspx</a></li>
</ul>

  </section>

  <footer>
    <div class="pull"></div>
      <div class="row">
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
    <a class="addthis_button_facebook"></a>
    <a class="addthis_button_twitter"></a>
    <a class="addthis_button_linkedin"></a>
    <a class="addthis_button_pinterest_share"></a>
    <a class="addthis_button_hackernews"></a>
    <a class="addthis_button_reddit"></a>
    <a class="addthis_button_google_plusone_share"></a>
    <a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a>
    </div>
    <script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-520fdca5596ba758"></script>
    <!-- AddThis Button END -->
</div>
      <div id="related-post" class="row">
        <h4>Related Posts</h4>
        
          
            
          
        
          
            
              
                <p  itemscope itemtype="http://schema.org/BlogPosting">
                  <a href="/posts/a-gudie-to-creating-a-basic-rest-api-series-introduction" rel="bookmark" title="Permanet link to A guide to creating a basic REST API - Series Introduction" itemprop="url">A guide to creating a basic REST API - Series Introduction</a>
                  <span> - <i class="icon-calendar"></i> <time title="2013-08-12T00:00:00-04:00" pubdate="2013-08-12T00:00:00-04:00" itemprop="datePublished">August 12, 2013</time></span>
                </p>
              
            
          
        
          
            
              
            
          
        
          
            
              
                <p  itemscope itemtype="http://schema.org/BlogPosting">
                  <a href="/posts/creating-a-mock-web-service-in-.net" rel="bookmark" title="Permanet link to Creating a Mock Web Service in .NET" itemprop="url">Creating a Mock Web Service in .NET</a>
                  <span> - <i class="icon-calendar"></i> <time title="2013-08-12T00:00:00-04:00" pubdate="2013-08-12T00:00:00-04:00" itemprop="datePublished">August 12, 2013</time></span>
                </p>
              
            
          
        
          
            
          
        
      </div>
      <div id="email-capture" class="row">
          <div class="col-lg-6 col-lg-offset-3 text-center">
            <div class="row"><div class="col-lg-12">
              <p>Subscribe to my mailing list
              </p>
            </div>
            <div class="col-lg-12">
              <div id="mc_embed_signup" class="row">
              <form action="http://utopianconcept.us7.list-manage.com/subscribe/post?u=6319e8bccb7eca0c94e55b132&amp;id=380501b246" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
                  <div class="col-lg-6 col-lg-offset-3 text-center mc-field-group">
                    <div class="input-group">
                      <input type="hidden" value="Creating a WiX installer for a .NET Web Project" name="ARTICLE" class="" id="mce-ARTICLE">
                      <input type="email" value="" name="EMAIL" class="form-control required email" id="mce-EMAIL" placeholder="email address" required>
                      <span class="input-group-btn">
                        <button class="btn btn-default" type="submit" name="subscribe" id="mc-embedded-subscribe">Subscribe</button>
                      </span>
                    </div>
                    <div class="col-lg-4 mce-responses">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>
                  </div>
                </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      <hr />
      
      <section class="comments" id="comments">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'utopianconcept';
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

      
  </footer>
</article>

</section>


  <footer id="footer" class="hidden-print" role="contentinfo">
    <section class="meta">
      <div class="container">
        <div class="row">
          <div class="col-lg-2 col-lg-offset-1">
            <a href="https://twitter.com/utopianconcept" itemprop="url" target="_blank">
              <i class="icon icon-twitter icon-4x"></i>
              <div>Follow me on Twitter</div>
            </a>
          </div>
          <div class="col-lg-2 next">
            <a href="https://github.com/rclanan" itemprop="url" target="_blank">
              <i class="icon icon-github icon-4x"></i>
              <div>
                See my github profile
              </div>
            </a>
          </div>
          <div class="col-lg-2 next">
            <a href="http://www.linkedin.com/in/raymondclanan" itemprop="url" target="_blank">
              <i class="icon icon-linkedin icon-4x"></i>
              <div>
                See my linkedin profile
              </div>
            </a>
          </div>
          <div class="col-lg-2 next">
            <a href="http://www.facebook.com/ray.clanan" itemprop="url" target="_blank">
              <i class="icon icon-facebook icon-4x"></i>
              <div>
                Connect on Facebook
              </div>
            </a>
          </div>
          <div class="col-lg-2 next">
            <a href="mailto:rclanan@utopianconcept.com" itemprop="url" target="_blank">
              <i class="icon icon-envelope icon-4x"></i>
              <div>
                Drop me an email
              </div>
            </a>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-6 col-lg-offset-3">
            <p class="disclaimer">
              <small>
                <strong>Disclaimer:</strong> This is my personal site. What I say here is mine and mine alone.
                My opinions have no bearing on my employer, and likewise, my employer has no claim over
                the ownership of the content on this site.
              </small>
            </p>
          </div>
        </div>
      </div>
    </section>
  </footer>
  
<script type="text/javascript">

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-42068834-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

</script>


  <script type="text/javascript">
var clicky_site_ids = clicky_site_ids || [];
clicky_site_ids.push(100642577);
(function() {
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = '//static.getclicky.com/js';
  ( document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0] ).appendChild( s );
})();
</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100642577ns.gif" /></p></noscript>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<script src="/js/scripts.js"></script>

</body>
</html>
